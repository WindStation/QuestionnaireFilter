# This file was generated by the Tkinter Designer by Parth Jadhav
# https://github.com/ParthJadhav/Tkinter-Designer


from pathlib import Path

# from tkinter import *
# Explicit imports to satisfy Flake8
from tkinter import Tk, Canvas, Entry, Text, Button, PhotoImage
from util.HighDPI import set_dpi_awareness
from processing.Filter import Filter
import os

set_dpi_awareness()

# OUTPUT_PATH = Path(__file__).parent
ASSETS_PATH = Path(r"GUI\build\build\assets\frame4")


def relative_to_assets(path: str) -> Path:
    return ASSETS_PATH / Path(path)


def start_window(filename, filter: Filter):
    """
    展示成功界面
    :param filename: 完整文件路径
    :param filter: `Filter`
    :return: None
    """
    os.startfile(os.path.join("Result", filter.filename))
    window = Tk()

    window.geometry("1200x740")
    window.configure(bg="#FFFFFF")
    window.title("筛选成功")

    canvas = Canvas(
        window,
        bg="#FFFFFF",
        height=740,
        width=1200,
        bd=0,
        highlightthickness=0,
        relief="ridge"
    )

    canvas.place(x=0, y=0)
    canvas.create_rectangle(
        0.0,
        0.0,
        1200.0,
        100.0,
        fill="#326199",
        outline="")

    canvas.create_text(
        121.0,
        25.0,
        anchor="nw",
        text="Metric",
        fill="#FFFFFF",
        font=("Consolas", 40 * -1)
    )

    canvas.create_text(
        776.5,
        33.0,
        anchor="n",
        text=filter.filename,
        fill="#FFFFFF",
        font=("Microsoft YaHei", 24 * -1)
    )

    canvas.create_rectangle(
        24.0,
        128.0,
        373.0,
        713.0,
        fill="#326299",
        outline="")

    canvas.create_text(
        38.0,
        162.0,
        width=321,
        anchor="nw",
        text="问卷筛选 · 说明：\n\n  \n\n\n  筛选已完成！\n\n你可以在该界面查看筛选结果摘要，也可以单击底部按钮，打开筛选结果文件。",
        fill="#FFFFFF",
        font=("Microsoft YaHei", 20 * -1)
    )

    canvas.create_text(
        47.0,
        605.0,
        anchor="nw",
        text="Designed & Developed By",
        fill="#FFFFFF",
        font=("Consolas Bold", 24 * -1)
    )

    canvas.create_text(
        126.0,
        650.0,
        anchor="nw",
        text="WindStation",
        fill="#FFFFFF",
        font=("Consolas Bold", 24 * -1)
    )

    canvas.create_text(
        637.0,
        83.0,
        anchor="nw",
        text="·",
        fill="#00FF19",
        font=("Microsoft YaHei", 128 * -1)
    )

    canvas.create_text(
        714.0,
        145.0,
        anchor="nw",
        text="筛选完成",
        fill="#000000",
        font=("Microsoft YaHei", 40 * -1)
    )

    canvas.create_text(
        634.0,
        264.0,
        anchor="nw",
        text="原问卷数据  " + str(filter.source_rows) + " 条",
        fill="#000000",
        font=("Microsoft YaHei", 32 * -1)
    )

    canvas.create_text(
        570.0,
        353.0,
        anchor="nw",
        text="筛选后问卷数据  " + str(filter.result_rows) + " 条",
        fill="#000000",
        font=("Microsoft YaHei", 32 * -1)
    )

    canvas.create_text(
        666.0,
        445.0,
        anchor="nw",
        text="无效数据  " + str(filter.source_rows - filter.result_rows) + " 条",
        fill="#000000",
        font=("Microsoft YaHei", 32 * -1)
    )

    button_image_1 = PhotoImage(
        file=relative_to_assets("button_1.png"))
    open_report_btn = Button(
        image=button_image_1,
        borderwidth=0,
        highlightthickness=0,
        command=lambda: os.startfile(os.path.join("Result", filter.filename, f"{filter.filename} 数据筛选报告.xlsx")),
        relief="flat"
    )
    open_report_btn.place(
        x=835.0,
        y=570.0,
        width=170.0,
        height=70.0
    )

    button_image_2 = PhotoImage(
        file=relative_to_assets("button_2.png"))
    open_file_btn = Button(
        image=button_image_2,
        borderwidth=0,
        highlightthickness=0,
        command=lambda: os.startfile(os.path.join("Result", filter.filename, f"{filter.filename} 筛选数据.xlsx")),
        relief="flat"
    )
    open_file_btn.place(
        x=564.0,
        y=570.0,
        width=191.0,
        height=70.0
    )
    window.resizable(False, False)
    window.mainloop()

    if __name__ == '__main__':
        start_window("1", None)
