# This file was generated by the Tkinter Designer by Parth Jadhav
# https://github.com/ParthJadhav/Tkinter-Designer
import os
from pathlib import Path

# from tkinter import *
# Explicit imports to satisfy Flake8
from tkinter import Tk, Canvas, Entry, Text, Button, PhotoImage
from util.HighDPI import set_dpi_awareness
from processing.Filter import Filter
from GUI.build.build import basic_info, param_info

set_dpi_awareness()

# OUTPUT_PATH = Path(__file__).parent
ASSETS_PATH = Path(r"GUI\build\build\assets\frame5")


def relative_to_assets(path: str) -> Path:
    return ASSETS_PATH / Path(path)


def start_window(filename, filter: Filter):
    """
    接收处理失败时filter的状态，并准备重新处理
    :param filename: 完整文件路径
    :param filter: Filter
    :return: None
    """
    window = Tk()

    window.geometry("1200x740")
    window.configure(bg="#FFFFFF")
    window.title("筛选失败")

    canvas = Canvas(
        window,
        bg="#FFFFFF",
        height=740,
        width=1200,
        bd=0,
        highlightthickness=0,
        relief="ridge"
    )

    canvas.place(x=0, y=0)
    canvas.create_rectangle(
        0.0,
        0.0,
        1200.0,
        100.0,
        fill="#326199",
        outline="")

    canvas.create_text(
        121.0,
        25.0,
        anchor="nw",
        text="Metric",
        fill="#FFFFFF",
        font=("Consolas", 40 * -1)
    )

    canvas.create_text(
        776.5,
        33.0,
        anchor="n",
        text=filter.filename,
        fill="#FFFFFF",
        font=("Microsoft YaHei", 24 * -1)
    )

    canvas.create_rectangle(
        24.0,
        128.0,
        373.0,
        713.0,
        fill="#326299",
        outline="")

    canvas.create_text(
        38.0,
        162.0,
        width=321,
        anchor="nw",
        text="问卷筛选 · 说明：\n\n  \n\n\n  出现了一些问题...\n\n请你按照右边的说明，查看问卷文件情况，或是返回先前的步骤，重新检查设置是否正确。",
        fill="#FFFFFF",
        font=("Microsoft YaHei", 20 * -1)
    )

    canvas.create_text(
        47.0,
        605.0,
        anchor="nw",
        text="Designed & Developed By",
        fill="#FFFFFF",
        font=("Consolas Bold", 24 * -1)
    )

    canvas.create_text(
        126.0,
        650.0,
        anchor="nw",
        text="WindStation",
        fill="#FFFFFF",
        font=("Consolas Bold", 24 * -1)
    )

    canvas.create_text(
        637.0,
        83.0,
        anchor="nw",
        text="·",
        fill="#FF0000",
        font=("Microsoft YaHei", 128 * -1)
    )

    canvas.create_text(
        714.0,
        145.0,
        anchor="nw",
        text="筛选失败",
        fill="#000000",
        font=("Microsoft YaHei", 40 * -1)
    )

    canvas.create_text(
        469.0,
        225.0,
        anchor="nw",
        text="出现错误可能是以下几个原因造成的：",
        fill="#000000",
        font=("Microsoft YaHei", 32 * -1)
    )

    canvas.create_text(
        479.0,
        300.0,
        anchor="nw",
        text="1. 检查问卷文件是否符合格式要求",
        fill="#000000",
        font=("Microsoft YaHei", 24 * -1)
    )

    canvas.create_text(
        503.0,
        380.0,
        anchor="nw",
        text="2. 检查基础信息设置是否正确",
        fill="#000000",
        font=("Microsoft YaHei", 24 * -1)
    )

    canvas.create_text(
        474.0,
        465.0,
        anchor="nw",
        text="3. 检查筛选条件参数设置是否正确",
        fill="#000000",
        font=("Microsoft YaHei", 24 * -1)
    )

    button_image_1 = PhotoImage(
        file=relative_to_assets("button_1.png"))
    openfile_btn = Button(
        image=button_image_1,
        borderwidth=0,
        highlightthickness=0,
        command=lambda: {
            os.startfile(filename)
        },
        relief="flat"
    )
    openfile_btn.place(
        x=901.0,
        y=291.0,
        width=138.0,
        height=52.0
    )

    button_image_2 = PhotoImage(
        file=relative_to_assets("button_2.png"))
    cancel_btn = Button(
        image=button_image_2,
        borderwidth=0,
        highlightthickness=0,
        command=lambda: window.destroy(),
        relief="flat"
    )
    cancel_btn.place(
        x=689.0,
        y=576.0,
        width=138.0,
        height=52.0
    )

    def to_basic():
        window.destroy()
        basic_info.start_window(filename, filter)

    button_image_3 = PhotoImage(
        file=relative_to_assets("button_3.png"))
    to_basic_btn = Button(
        image=button_image_3,
        borderwidth=0,
        highlightthickness=0,
        command=to_basic,
        relief="flat"
    )
    to_basic_btn.place(
        x=884.0,
        y=372.0,
        width=172.0,
        height=52.0
    )

    def to_param():
        window.destroy()
        param_info.start_window(filename, filter)

    button_image_4 = PhotoImage(
        file=relative_to_assets("button_4.png"))
    to_param_btn = Button(
        image=button_image_4,
        borderwidth=0,
        highlightthickness=0,
        command=to_param,
        relief="flat"
    )
    to_param_btn.place(
        x=884.0,
        y=453.0,
        width=172.0,
        height=52.0
    )
    window.resizable(False, False)
    window.mainloop()


if __name__ == '__main__':
    start_window("D:/WindStation/Documents/Pycharm/QuestionnaireFilter/Source/测试问卷1.xlsx", None)
